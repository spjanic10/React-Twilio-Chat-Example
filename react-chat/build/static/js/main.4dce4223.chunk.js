(this["webpackJsonpreact-chat"]=this["webpackJsonpreact-chat"]||[]).push([[0],{154:function(e,t,n){e.exports={Dropzone:"Conversation_Dropzone__15hnk",drop:"Conversation_drop__2apuC",active:"Conversation_active__1BNWw",messages:"Conversation_messages__1KgS7",Highlight:"Conversation_Highlight__1jIO5","type-a-message":"Conversation_type-a-message__2ks33"}},156:function(e,t,n){e.exports={"conversation-item":"ConversationsItem_conversation-item__1DIn_","conversation-item--active":"ConversationsItem_conversation-item--active__39CfD","conversation-item-text":"ConversationsItem_conversation-item-text__2VjQK"}},263:function(e,t,n){},289:function(e,t,n){e.exports={"chat-channels-list":"ConversationsList_chat-channels-list__228lf"}},302:function(e,t,n){},303:function(e,t,n){},397:function(e,t){},420:function(e,t){},456:function(e,t){},46:function(e,t,n){e.exports={incoming_msg_img:"MessageBubble_incoming_msg_img__2NTPH",received_msg:"MessageBubble_received_msg__29axb",received_withd_msg:"MessageBubble_received_withd_msg__2MC6p",time_date:"MessageBubble_time_date__3sfzs",sent_msg:"MessageBubble_sent_msg__Il0B-",outgoing_msg:"MessageBubble_outgoing_msg__1yX32",input_msg_write:"MessageBubble_input_msg_write__2C3Y9",image:"MessageBubble_image__3ovCZ",picture_preview:"MessageBubble_picture_preview__Xdxpt",media_icon:"MessageBubble_media_icon__27H33",picture_container:"MessageBubble_picture_container__h5Eje",media:"MessageBubble_media__3tn1o",placeholder:"MessageBubble_placeholder__1ib-9",medias:"MessageBubble_medias__1QOlg"}},485:function(e,t,n){},603:function(e,t,n){},605:function(e,t,n){"use strict";n.r(t);var s=n(0),a=n.n(s),o=n(8),i=n.n(o),r=(n(302),n(34)),c=n(57),l=n(36),d=n(35),u=(n.p,n(303),n(96)),j=n(15),g=n.n(j),b=n(104),m=n(611),h=n(607),v=n(198),p=(n(263),n(485),n(69)),f=n(293),x=n(154),O=n.n(x),y=n(12),_=n(608),C=n(610),w=n(82),S=n(46),M=n.n(S),k=n(609),P=n(282),I=n(3),B=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(r.a)(this,n);for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).render=function(){return Object(I.jsx)("svg",{width:"1em",height:"1em",viewBox:"0 0 1024 1024",children:Object(I.jsx)("path",{fill:"currentColor",d:"M161.69,935.7060000000001C161.69,935.7060000000001,161.69,681.344,161.69,681.344C161.69,681.344,0,681.344,0,681.344C0,681.344,0,88.50000000000011,0,88.50000000000011C0,88.50000000000011,1024,88.50000000000011,1024,88.50000000000011C1024,88.50000000000011,1024,681.344,1024,681.344C1024,681.344,504.986,681.344,504.986,681.344C504.986,681.344,161.69,935.7060000000001,161.69,935.7060000000001C161.69,935.7060000000001,161.69,935.7060000000001,161.69,935.7060000000001M53.914,627.4310000000002C53.914,627.4310000000002,215.603,627.4310000000002,215.603,627.4310000000002C215.603,627.4310000000002,215.603,828.4420000000001,215.603,828.4420000000001C215.603,828.4420000000001,485.069,627.4310000000002,485.069,627.4310000000002C485.069,627.4310000000002,970.086,627.4310000000002,970.086,627.4310000000002C970.086,627.4310000000002,970.086,142.36200000000008,970.086,142.36200000000008C970.086,142.36200000000008,53.914,142.36200000000008,53.914,142.36200000000008C53.914,142.36200000000008,53.914,627.4310000000002,53.914,627.4310000000002C53.914,627.4310000000002,53.914,627.4310000000002,53.914,627.4310000000002M161.69,384.8960000000002C161.69,447.1560000000002,229.069,486.0160000000001,282.931,454.9380000000001C307.968,440.4480000000001,323.379,413.77300000000014,323.379,384.8960000000002C323.379,322.6880000000001,256,283.7760000000002,202.086,314.9060000000002C177.101,329.34400000000016,161.69,356.0200000000001,161.69,384.8960000000002M431.155,384.8960000000002C431.155,447.1560000000002,498.534,486.0160000000001,552.448,454.9380000000001C577.434,440.4480000000001,592.845,413.77300000000014,592.845,384.8960000000002C592.845,322.6880000000001,525.466,283.7760000000002,471.603,314.9060000000002C446.566,329.34400000000016,431.155,356.0200000000001,431.155,384.8960000000002M700.621,384.8960000000002C700.621,447.1560000000002,768,486.0160000000001,821.914,454.9380000000001C846.899,440.4480000000001,862.31,413.77300000000014,862.31,384.8960000000002C862.31,322.6880000000001,794.931,283.7760000000002,741.069,314.9060000000002C716.032,329.34400000000016,700.621,356.0200000000001,700.621,384.8960000000002"})})},e}return n}(s.PureComponent),D=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var s;return Object(r.a)(this,n),(s=t.call(this,e)).componentDidMount=Object(b.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=s,e.t1=p.a,e.t2=Object(p.a)({},s.state),e.t3={},e.next=6,s.props.message.getParticipant();case 6:e.t4=e.sent.type,e.t5={type:e.t4},e.t6=(0,e.t1)(e.t2,e.t3,e.t5),e.t0.setState.call(e.t0,e.t6),s.state.hasMedia&&s.props.message.media.getContentTemporaryUrl().then((function(e){s.setState({mediaUrl:e})})).catch((function(e){return s.setState({mediaDownloadFailed:!0})})),document.getElementById(s.props.message.sid).scrollIntoView({behavior:"smooth"});case 12:case"end":return e.stop()}}),e)}))),s.render=function(){var e="incoming"===s.props.direction?{itemStyle:M.a.received_msg,divStyle:M.a.received_withd_msg}:{itemStyle:M.a.outgoing_msg,divStyle:M.a.sent_msg},t=e.itemStyle,n=e.divStyle,a=s.props.message,o=s.state.type;return s.state.hasMedia&&(console.log("Message is media message"),console.log("Media properties",a.media)),console.log(a),Object(I.jsx)("li",{id:a.sid,className:t,children:Object(I.jsxs)("div",{className:n,children:[Object(I.jsxs)("div",{children:[Object(I.jsxs)("strong",{children:["chat"===o&&Object(I.jsx)(y.a,{style:{fontSize:"16px"},component:B}),"sms"===o&&Object(I.jsx)(y.a,{type:"mobile"})," ".concat(a.author)]}),Object(I.jsx)("br",{}),Object(I.jsx)("div",{className:M.a.medias,children:s.state.hasMedia&&Object(I.jsx)(N,{hasFailed:s.state.mediaDownloadFailed,url:s.state.mediaUrl})}),a.body]}),Object(I.jsx)("span",{className:M.a.time_date,children:a.state.timestamp.toLocaleString()})]})})},s.state={hasMedia:"media"===s.props.message.type,mediaDownloadFailed:!1,mediaUrl:null},s}return Object(c.a)(n,[{key:"componentDidUpdate",value:function(e,t,n){document.getElementById(this.props.message.sid).scrollIntoView({behavior:"smooth"})}}]),n}(s.Component),N=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(r.a)(this,n);for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).render=function(){var t=e.props,n=t.hasFailed,s=t.url;return Object(I.jsxs)("div",{className:"".concat(M.a.media).concat(s?"":" "+M.a.placeholder),onClick:function(){k.a.info({centered:!0,icon:null,okText:"Close",width:"60%",content:Object(I.jsx)("div",{className:M.a.picture_container,children:Object(I.jsx)("img",{style:{width:"100%",height:"100%"},alt:"description",src:s})})})},children:[!s&&!n&&Object(I.jsx)(P.a,{}),n&&Object(I.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[Object(I.jsx)(y.a,{type:"warning",style:{fontSize:"5em"}}),Object(I.jsx)("p",{children:"Failed to load media"})]}),!n&&s&&Object(I.jsxs)("div",{className:M.a.media_icon,children:[Object(I.jsx)("div",{style:{zIndex:123,position:"absolute"},children:Object(I.jsx)(y.a,{type:"eye",style:{fontSize:"5em",opacity:.3}})}),Object(I.jsx)("div",{className:M.a.picture_preview,style:{backgroundImage:"url(".concat(s,")"),zIndex:122}})]})]})},e}return n}(s.PureComponent),T=D,R=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(r.a)(this,n);for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).render=function(){return Object(I.jsx)("div",{id:"messages",children:Object(I.jsx)("ul",{children:e.props.messages.map((function(t){return t.author===e.props.identity?Object(I.jsx)(T,{direction:"outgoing",message:t},t.index):Object(I.jsx)(T,{direction:"incoming",message:t},t.index)}))})})},e}return n}(s.PureComponent),z=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var s;return Object(r.a)(this,n),(s=t.call(this,e)).loadMessagesFor=function(e){s.state.conversationProxy===e&&e.getMessages().then((function(t){s.state.conversationProxy===e&&s.setState({messages:t.items,loadingState:"ready"})})).catch((function(e){console.error("Couldn't fetch messages IMPLEMENT RETRY",e),s.setState({loadingState:"failed"})}))},s.componentDidMount=function(){if(s.state.conversationProxy&&(s.loadMessagesFor(s.state.conversationProxy),!s.state.boundConversations.has(s.state.conversationProxy))){var e=s.state.conversationProxy;e.on("messageAdded",(function(t){return s.messageAdded(t,e)})),s.setState({boundConversations:new Set([].concat(Object(u.a)(s.state.boundConversations),[e]))})}},s.componentDidUpdate=function(e,t){if(s.state.conversationProxy!==t.conversationProxy&&(s.loadMessagesFor(s.state.conversationProxy),!s.state.boundConversations.has(s.state.conversationProxy))){var n=s.state.conversationProxy;n.on("messageAdded",(function(e){return s.messageAdded(e,n)})),s.setState({boundConversations:new Set([].concat(Object(u.a)(s.state.boundConversations),[n]))})}},s.messageAdded=function(e,t){t===s.state.conversationProxy&&s.setState((function(t,n){return{messages:[].concat(Object(u.a)(t.messages),[e])}}))},s.onMessageChanged=function(e){s.setState({newMessage:e.target.value})},s.sendMessage=function(e){e.preventDefault();var t=s.state.newMessage;s.setState({newMessage:""}),s.state.conversationProxy.sendMessage(t)},s.onDrop=function(e){s.state.conversationProxy.sendMessage({contentType:e[0].type,media:e[0]})},s.render=function(){return Object(I.jsx)(f.a,{onDrop:s.onDrop,accept:"image/*",children:function(e){var t=e.getRootProps,n=e.getInputProps,a=e.isDragActive;return Object(I.jsxs)("div",Object(p.a)(Object(p.a)({},t()),{},{onClick:function(){},id:"OpenChannel",style:{position:"relative",top:0},children:[a&&Object(I.jsxs)("div",{className:O.a.drop,children:[Object(I.jsx)(y.a,{type:"cloud-upload",style:{fontSize:"5em",color:"#fefefe"}}),Object(I.jsx)("h3",{style:{color:"#fefefe"},children:"Release to Upload"})]}),Object(I.jsxs)("div",{className:O.a.messages,style:{filter:"blur(".concat(a?4:0,"px)")},children:[Object(I.jsx)("input",Object(p.a)({id:"files"},n())),Object(I.jsx)("div",{style:{flexBasis:"100%",flexGrow:2,flexShrink:1,overflowY:"scroll"},children:Object(I.jsx)(R,{identity:s.props.myIdentity,messages:s.state.messages})}),Object(I.jsx)("div",{children:Object(I.jsx)(_.a,{onSubmit:s.sendMessage,children:Object(I.jsxs)(C.a.Group,{compact:!0,style:{width:"100%",display:"flex",flexDirection:"row"},children:[Object(I.jsx)(C.a,{style:{flexBasis:"100%"},placeholder:"Type your message here...",type:"text",name:"message",id:O.a["type-a-message"],autoComplete:"off",disabled:"ready"!==s.state.loadingState,onChange:s.onMessageChanged,value:s.state.newMessage}),Object(I.jsx)(w.a,{icon:"enter",htmlType:"submit",type:"submit"})]})})})]})]}))}})},s.state={newMessage:"",conversationProxy:e.conversationProxy,messages:[],loadingState:"initializing",boundConversations:new Set},s}return Object(c.a)(n,null,[{key:"getDerivedStateFromProps",value:function(e,t){return"initializing"===t.loadingState||t.conversationProxy!==e.conversationProxy?{loadingState:"loading messages",conversationProxy:e.conversationProxy}:null}}]),n}(s.Component),A=n(606),E=n(289),F=n.n(E),U=n(156),L=n.n(U);var H=h.a.Text,W=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var e=this.props,t=e.conversations,n=e.selectedConversationSid,s=e.onConversationClick;return Object(I.jsx)(A.a,{className:F.a["conversations-list"],bordered:!0,loading:0===t.length,dataSource:t,renderItem:function(e){var t=e.sid===n,a=[L.a["conversation-item"],t&&L.a["conversation-item--active"]].filter(Boolean).join(" ");return Object(I.jsx)(A.a.Item,{onClick:function(){return s(e)},className:a,children:Object(I.jsx)(H,{strong:!0,className:L.a["conversation-item-text"],children:e.friendlyName||e.sid})},e.sid)}})}}]),n}(a.a.Component),V=function(e){var t=e.children,n=e.style,s=Object(p.a)({padding:"0 19px 0 19px"},n);return Object(I.jsx)("div",{style:s,children:t})},G=n(203),J=n.n(G);var X=m.a.Content,Y=m.a.Sider,K=m.a.Header,Q=h.a.Text,Z=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var s;Object(r.a)(this,n),(s=t.call(this,e)).componentDidMount=function(){s.state.loggedIn&&s.getToken()},s.logIn=function(e){""!==e&&(localStorage.setItem("name",e),s.setState({name:e,loggedIn:!0},s.getToken))},s.getUsername=Object(b.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=J.a.get("".concat("","/users")).then((function(e){return e.data})),e.abrupt("return",t);case 2:case"end":return e.stop()}}),e)}))),s.getToken=Object(b.a)(g.a.mark((function e(){var t;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.getUsername();case 2:t=e.sent,J.a.get("https://sunglow-dotterel-5846.twil.io/chat-token?identity="+t).then((function(e){s.setState({token:e.data.token},s.initConversations)}));case 4:case"end":return e.stop()}}),e)}))),s.initConversations=Object(b.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return window.conversationsClient=v.Client,e.next=3,v.Client.create(s.state.token);case 3:s.conversationsClient=e.sent,s.conversationsClient.on("connectionStateChanged",(function(e){"connecting"===e&&s.setState({status:"default"}),"connected"===e&&s.setState({status:"success"}),"disconnecting"===e&&s.setState({conversationsReady:!1,status:"default"}),"disconnected"===e&&s.setState({conversationsReady:!1,status:"warning"}),"denied"===e&&s.setState({conversationsReady:!1,status:"error"})})),s.conversationsClient.on("conversationJoined",(function(e){s.setState({conversations:[].concat(Object(u.a)(s.state.conversations),[e])})})),s.conversationsClient.on("conversationLeft",(function(e){s.setState({conversations:Object(u.a)(s.state.conversations.filter((function(t){return t!==e})))})}));case 7:case"end":return e.stop()}}),e)})));var a=localStorage.getItem("name")||"";return s.state={name:a,loggedIn:!0,token:null,conversationsReady:!1,conversations:[],selectedConversationSid:null,newMessage:"",username:null},s}return Object(c.a)(n,[{key:"render",value:function(){var e,t=this,n=this.state,s=n.conversations,a=n.selectedConversationSid,o=n.status,i=s.find((function(e){return e.sid===a}));if(console.log(a),e=i?Object(I.jsx)(z,{conversationProxy:i,myIdentity:this.state.name}):"success"!==o?"Loading your conversation!":"",this.state.loggedIn)return Object(I.jsxs)("div",{className:"conversations-window-wrapper",children:[Object(I.jsxs)(K,{style:{display:"flex",padding:0,background:"black"},children:[Object(I.jsxs)("div",{style:{maxWidth:"250px",width:"100%",display:"flex"},children:[Object(I.jsx)(V,{style:{float:"left"},children:Object(I.jsx)("a",{href:"/",children:Object(I.jsx)("button",{style:{float:"left",background:"transparent",color:"white"},children:"HOME"})})}),Object(I.jsx)(V,{style:{float:"right",marginLeft:"auto"}})]}),Object(I.jsxs)("div",{style:{maxWidth:"250px",width:"100%",display:"flex",float:"right",marginLeft:"50%"},children:[Object(I.jsx)(V,{children:Object(I.jsx)("a",{href:"/dashboard",children:Object(I.jsx)("button",{style:{background:"transparent",color:"white"},children:"DASHBOARD"})})}),Object(I.jsx)(V,{children:Object(I.jsx)("a",{href:"/app",children:Object(I.jsx)("button",{style:{background:"transparent",color:"white"},children:"INBOX"})})}),Object(I.jsx)(V,{children:Object(I.jsx)("a",{href:"/logout",children:Object(I.jsx)("button",{style:{background:"transparent",color:"white"},children:"LOGOUT"})})})]})]}),Object(I.jsx)(m.a,{className:"conversations-window-container",children:Object(I.jsxs)(m.a,{children:[Object(I.jsx)(Y,{theme:"light",width:250,children:Object(I.jsx)(W,{conversations:s,selectedConversationSid:a,onConversationClick:function(e){t.setState({selectedConversationSid:e.sid})}})}),Object(I.jsx)(X,{className:"conversation-section",children:Object(I.jsxs)("div",{id:"SelectedConversation",children:[Object(I.jsxs)(K,{style:{display:"flex",padding:0,background:"#222222"},children:[Object(I.jsx)("div",{style:{maxWidth:"250px",width:"100%",display:"flex",float:"right",marginLeft:"auto"},children:Object(I.jsx)(Q,{strong:!0,style:{color:"white",float:"right"},children:i&&(i.friendlyName||i.sid)})}),Object(I.jsx)(V,{children:Object(I.jsx)("a",{href:"/report",children:Object(I.jsx)("button",{style:{background:"transparent",color:"white"},children:"REPORT"})})}),Object(I.jsx)(V,{children:Object(I.jsx)("a",{href:"/review",children:Object(I.jsx)("button",{style:{background:"transparent",color:"white"},children:"REVIEW"})})})]}),e]})})]})})]})}}]),n}(a.a.Component),$=(n(603),n(604),function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var s;return Object(r.a)(this,n),(s=t.call(this,e)).state={},s}return Object(c.a)(n,[{key:"render",value:function(){return Object(I.jsx)(Z,{})}}]),n}(s.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object(I.jsx)($,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[605,1,2]]]);
//# sourceMappingURL=main.4dce4223.chunk.js.map